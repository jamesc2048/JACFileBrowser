name: JACFileBrowser build
on: push
jobs:
  Build-JACFileExplorer:
    runs-on: windows-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Install Python
        uses: actions/setup-python@v4
      - uses: TheMrMilchmann/setup-msvc-dev@v3
        with:
          arch: x64
      - name: Setup Ninja
        uses: ashutoshvarma/setup-ninja@master
      - name: Install Qt
        uses: jurplel/install-qt-action@v3
        with:
          aqtversion: '==3.1.*'
          version: '6.6.0'
          host: 'windows'
          target: 'desktop'
          arch: 'win64_msvc2019_64'
          modules: 'qtimageformats qtmultimedia'
          tools: 'tools_cmake tools_vcredist,qt.tools.vcredist_msvc2019_x64'
          archives: 'qttools qtsvg qtdeclarative qtbase d3dcompiler_47'
      - run: echo $GITHUB_WORKSPACE
      - run: ls $GITHUB_WORKSPACE
      - name: Build with CMake
        uses: ashutoshvarma/action-cmake-build@master
        with:
          source-dir: JACFileBrowser
          build-dir: ${{ runner.workspace }}/build
          cc: cl
          cxx: cl
          configure-options: -G Ninja -DCMAKE_INSTALL_PREFIX=${{ runner.workspace }}/install
          build-type: Release
          install-build: true
      - run: $Qt6_DIR/bin/windeployqt6.exe ${{ runner.workspace }}/install/appJACFileBrowser.exe --qmldir JACFileBrowser --no-opengl-sw --no-translations --no-virtualkeyboard --release
      - run: ls ${{ runner.workspace }}/install/bin/
      

      # - name: Upload build
      #   uses: actions/upload-artifact@v2
      #   with:
      #     name: windows
      #     path: |
      #       spark.exe
